@startuml
actor "<u>:Admin" as admin
participant "<u>:Terminal" as terminal
participant "<u>:LessonCollection" as lessonCollection
participant "<u>:LocationCollection" as locationCollection
collections "<u>:Lesson" as lessons
collections "<u>:Location" as locations
participant "<u>lesson:Lesson" as lessonObj

admin -> terminal : requestCreateLesson()
activate admin
activate terminal
terminal -> locationCollection : getLocations()
activate locationCollection
locationCollection -> locations : getAll()
activate locations
locations -> locationCollection : locations
deactivate locations
locationCollection -> terminal : locations
deactivate locationCollection
terminal --> admin : displayLocations
deactivate terminal
deactivate admin

admin -> terminal : selectLocation(locationId)
activate admin
activate terminal
terminal -> admin : requestLessonDetails
deactivate terminal
deactivate admin

admin -> terminal : inputLessonDetails(title, lessonType, startTime, endTime, schedule)
activate admin
activate terminal
terminal -> lessonCollection : validateLesson(locationId, startTime, endTime, schedule)
activate lessonCollection
lessonCollection -> lessons : checkForConflictingLesson(locationId, startTime, endTime, schedule)
activate lessons

alt No Conflicts
    lessons -> lessonCollection : noConflict
    lessonCollection -> terminal : success
    
    terminal -> locationCollection : createLesson(locationId, title, lessonType, startTime, endTime, schedule)
    activate locationCollection
    locationCollection -> lessonObj ** : create(locationId, title, lessonType, startTime, endTime, schedule)
    activate lessonObj
    lessonObj -> locationCollection : lesson
    deactivate lessonObj

    alt Lesson Created Successfully
        locationCollection -> locations : add(location)
        activate locationCollection
        activate locations
        locations --> locationCollection : success
        deactivate locationCollection
        deactivate locations
        locationCollection -> terminal : success
        terminal -> admin : successMessage
    else Lesson Creation Failed
        locationCollection -> terminal : failure
        terminal -> admin : failureMessage
    end
    deactivate locationCollection
else Conflicts Found
    lessons -> lessonCollection : conflict
    deactivate lessons
    lessonCollection -> terminal : failure
    terminal -> admin : failureMessage
    deactivate lessonCollection
end
deactivate admin
deactivate terminal
@enduml